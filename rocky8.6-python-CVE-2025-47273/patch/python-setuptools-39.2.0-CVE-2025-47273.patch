--- a/setuptools/package_index.py
+++ b/setuptools/package_index.py
@@ -805,7 +805,13 @@ class PackageIndex(Environment):
         if name.endswith('.egg.zip'):
             name = name[:-4]  # strip the extra .zip before download

-        filename = os.path.join(tmpdir, name)
+        filename = os.path.join(tmpdir, name)
+
+        # ensure path resolves within the tmpdir (CVE-2025-47273 fix)
+        if not filename.startswith(str(tmpdir)):
+            raise ValueError(f"Invalid filename {filename}")
+
+        # filename is now validated

         # Download the file
         #
