// CVE-2025-8677 POC - Authoritative Server Configuration
// Serves malformed DNSKEY records (no validation)

options {
    directory "/var/named";
    pid-file "/var/run/named/named.pid";
    session-keyfile "/var/run/named/session.key";

    listen-on port 53 { any; };
    listen-on-v6 port 53 { any; };

    allow-query { any; };
    recursion no;  // Authoritative only
    dnssec-enable yes;

    // Disable query logging for cleaner output
    querylog no;
};

// Logging configuration
logging {
    channel default_log {
        file "/var/log/named/default.log" versions 3 size 5m;
        severity info;
        print-time yes;
        print-severity yes;
        print-category yes;
    };

    channel security_log {
        file "/var/log/named/security.log" versions 3 size 5m;
        severity info;
        print-time yes;
    };

    category default { default_log; };
    category security { security_log; };
    category dnssec { default_log; };
};

// Zone with malformed DNSKEY records
zone "example.com" IN {
    type master;
    file "malformed.zone";
    allow-query { any; };
};
