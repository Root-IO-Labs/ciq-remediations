--- a/lib/dns/validator.c	2021-11-05 14:33:26.000000000 +0000
+++ b/lib/dns/validator.c	2025-11-28 19:30:00.000000000 +0000
@@ -1265,6 +1265,14 @@
 				goto done;
 			}
 			dst_key_free(&val->key);
+		/*
+		 * CVE-2025-8677: Stop processing on critical errors
+		 * to prevent CPU exhaustion from malformed keys
+		 */
+		if (result != ISC_R_SUCCESS) {
+			break;
+		}
+		val->key = NULL;
 		}
 		dns_rdata_reset(&rdata);
 		result = dns_rdataset_next(rdataset);
@@ -1383,13 +1391,18 @@
 				      "keyset with trust %s",
 				      dns_trust_totext(val->frdataset.trust));
 			result = get_dst_key(val, siginfo, val->keyset);
-			if (result != ISC_R_SUCCESS) {
+			if (result == ISC_R_NOTFOUND) {
 				/*
-				 * Either the key we're looking for is not
-				 * in the rrset, or something bad happened.
-				 * Give up.
+				 * The key we're looking for is not
+				 * in the rrset
 				 */
 				result = DNS_R_CONTINUE;
+			} else if (result != ISC_R_SUCCESS) {
+				/*
+				 * CVE-2025-8677: Something bad happened.
+				 * Return error to prevent CPU exhaustion.
+				 */
+				return (result);
 			}
 		}
 	} else if (result == ISC_R_NOTFOUND) {
@@ -1486,8 +1499,13 @@
 			dstkey = NULL;
 			result = dns_dnssec_keyfromrdata(name, &rdata, mctx,
 							 &dstkey);
-			if (result != ISC_R_SUCCESS)
-				continue;
+			if (result != ISC_R_SUCCESS) {
+				/*
+				 * CVE-2025-8677: Return error on malformed keys
+				 * to prevent CPU exhaustion attacks
+				 */
+				return (result);
+			}
 
 			result = dns_dnssec_verify3(name, rdataset, dstkey,
 						    true,
@@ -1734,11 +1752,13 @@
 							 keyrdata,
 							 val->view->mctx,
 							 &dstkey);
-			if (result != ISC_R_SUCCESS)
+			if (result != ISC_R_SUCCESS) {
 				/*
-				 * This really shouldn't happen, but...
+				 * CVE-2025-8677: Return error on malformed keys
+				 * to prevent CPU exhaustion attacks
 				 */
-				continue;
+				return (result);
+			}
 		}
 		result = verify(val, dstkey, &rdata, sig.keyid);
 		if (result == ISC_R_SUCCESS)
