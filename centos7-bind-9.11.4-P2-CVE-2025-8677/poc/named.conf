// CVE-2025-8677 POC - BIND Configuration
// Minimal configuration for testing malformed DNSKEY vulnerability

options {
    directory "/var/named";
    pid-file "/var/run/named/named.pid";
    session-keyfile "/var/run/named/session.key";

    listen-on port 53 { any; };
    listen-on-v6 port 53 { any; };

    allow-query { any; };
    recursion no;
    dnssec-enable yes;
    dnssec-validation yes;

    // Disable query logging for cleaner output
    querylog no;
};

// Logging configuration
logging {
    channel default_log {
        file "/var/log/named/default.log" versions 3 size 5m;
        severity info;
        print-time yes;
        print-severity yes;
        print-category yes;
    };

    channel security_log {
        file "/var/log/named/security.log" versions 3 size 5m;
        severity info;
        print-time yes;
    };

    category default { default_log; };
    category security { security_log; };
    category dnssec { default_log; };
};

// Trust anchor for root zone
trusted-keys {
    // Root KSK from IANA (for DNSSEC validation)
    "." 257 3 8 "AwEAAaz/tAm8yTn4Mfeh5eyI96WSVexTBAvkMgJzkKTOiW1vkIbzxeF3
                  +/4RgWOq7HrxRixHlFlExOLAJr5emLvN7SWXgnLh4+B5xQlNVz8Og8kv
                  ArMtNROxVQuCaSnIDdD5LKyWbRd2n9WGe2R8PzgCmr3EgVLrjyBxWezF
                  0jLHwVN8efS3rCj/EWgvIWgb9tarpVUDK/b58Da+sqqls3eNbuv7pr+e
                  oZG+SrDK6nWeL3c6H5Apxz7LjVc1uTIdsIXxuOLYA4/ilBmSVIzuDWfd
                  RUfhHdY6+cn8HFRm+2hM8AnXGXws9555KrUB5qihylGa8subX2Nn6UwN
                  R1AkUTV74bU=";
};

// Zone for POC testing
zone "example.com" IN {
    type master;
    file "malformed.zone";
    allow-query { any; };
};

// Root hints (minimal for testing)
zone "." IN {
    type hint;
    file "root.hint";
};
